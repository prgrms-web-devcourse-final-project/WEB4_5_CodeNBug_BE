<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/fragments/layout :: head('사용자 관리')">
</head>
<body>
    <!-- 사이드바 -->
    <div th:replace="admin/fragments/layout :: sidebar" th:with="currentPage='users'"></div>

    <!-- 메인 컨텐츠 -->
    <div class="content">
        <div class="dashboard-header d-flex justify-content-between align-items-center">
            <h4 class="mb-0">사용자 관리</h4>
        </div>

        <!-- 오류 메시지 표시 -->
        <div th:if="${errorMessage}" class="alert alert-danger mb-4" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <span th:text="${errorMessage}">오류 메시지</span>
        </div>

        <!-- 일반 사용자 -->
        <div class="card mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0">일반 사용자</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>이메일</th>
                                <th>이름</th>
                                <th>가입일</th>
                                <th>역할</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${regularUsers == null || regularUsers.isEmpty()}">
                                <td colspan="6" class="text-center py-4 text-muted">
                                    등록된 일반 사용자가 없습니다.
                                </td>
                            </tr>
                            <tr th:each="user : ${regularUsers}">
                                <td th:text="${user.userId}">1</td>
                                <td th:text="${user.email}">user@example.com</td>
                                <td th:text="${user.name}">홍길동</td>
                                <td th:text="${#temporals.format(user.createdAt, 'yyyy-MM-dd HH:mm')}">2023-01-01 12:00</td>
                                <td>
                                    <select class="form-select" th:attr="data-original-role=${user.role}" 
                                            onchange="changeUserRole('regular', [[${user.userId}]], this)">
                                        <option th:each="role : ${roles}" 
                                                th:value="${role}" 
                                                th:text="${role}"
                                                th:selected="${user.role == role}">USER</option>
                                    </select>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">상세</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SNS 사용자 -->
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0">SNS 사용자</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>소셜 ID</th>
                                <th>제공자</th>
                                <th>이메일</th>
                                <th>이름</th>
                                <th>가입일</th>
                                <th>역할</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${snsUsers == null || snsUsers.isEmpty()}">
                                <td colspan="8" class="text-center py-4 text-muted">
                                    등록된 SNS 사용자가 없습니다.
                                </td>
                            </tr>
                            <tr th:each="user : ${snsUsers}">
                                <td th:text="${user.id}">1</td>
                                <td th:text="${user.socialId}">social_id</td>
                                <td th:text="${user.provider}">KAKAO</td>
                                <td th:text="${user.email}">user@example.com</td>
                                <td th:text="${user.name}">홍길동</td>
                                <td th:text="${#dates.format(user.createdAt, 'yyyy-MM-dd HH:mm')}">2023-01-01 12:00</td>
                                <td>
                                    <select class="form-select" th:attr="data-original-role=${user.role}" 
                                            onchange="changeUserRole('sns', [[${user.id}]], this)">
                                        <option th:each="role : ${roles}" 
                                                th:value="${role}" 
                                                th:text="${role}"
                                                th:selected="${user.role == role}">USER</option>
                                    </select>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">상세</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="admin/fragments/layout :: scripts"></div>
</body>
</html> 