# 기능 명세서

완료된 작업 : ✅

미완료 작업 : ☑️

후순위 작업 : ⏳

## 1. 사용자 관리 ✅

### 1-1. 회원가입 ✅

| 항목           | 내용                                                                             |
|--------------|--------------------------------------------------------------------------------|
| **기능 ID**    | USR-001                                                                        |
| **기능명**      | 이메일 기반 회원가입 및 인증                                                               
 SNS 회원가입/로그인 |
| **목적**       | - 사용자가 이메일, 비밀번호, 이름 등 개인정보를 입력하여 신규 계정을 생성하며, 이메일 인증을 통해 입력한 이메일의 유효성을 검증합니다. 

- SNS 계정을 통한 회원가입 및 로그인도 지원합니다.
- 지원하는 계정은 카카오, 네이버, 구글입니다. |
  | **관련 메뉴** | 회원가입 페이지 (`/signup`) |
  | **입력값** | 이메일 기반 회원가입
- 이메일
- 비밀번호
- 이름
- 성별
- 나이
- 휴대폰 번호
- 서비스 사용 지역

OAuth 기반 회원가입

- 성별
- 나이
- 휴대폰 번호
- 서비스 사용 지역 |
  | **처리 로직** | 이메일 기반 회원가입

1. 사용자가 회원가입 폼에 정보 입력
2. 회원가입 정보 전송 전 이메일 중복 여부 확인
3. 회원 유저 인증 진행 ( 휴대폰 번호 인증 )
   4 서버는 비밀번호를 해시 알고리즘으로 변환하여 저장
5. JavaMailSender와 Google SMTP를 활용해 이메일 인증 url 발송
6. 사용자가 url을 클릭해 진입하면 계정 활성화

OAuth 기반 회원가입

1. 클라이언트가 OAuth 공급자 로그인 화면으로 리다이렉트
2. 공급자는 로그인 이후 임시 코드와 함께 클라이언트로 리다이렉트
3. 클라이언트는 임시 코드를 공급자에게 전달해 인증 코드를 받음
4. 클라이언트는 리소스 서버에 유저 정보를 인증 코드와 함께 요청
5. 응답받은 유저 정보와 유저가 제공한 정보로 회원가입 |
   | **출력값** | 회원가입 완료 메시지 및 회원가입 완료한 계정 정보
   (오류 시: 중복 가입 오류, 데이터 누락, 데이터 형식 잘못됨 메시지) |
   | **비고** | - 이메일 인증 url 만료 시간(TTL) 3분

- 인증 재시도 기능 포함 |
  | API 설계 | [**회원가입 (POST /api/v1/users/signup)
  **](https://www.notion.so/POST-api-v1-users-signup-e207791bd93e4048ab159786bbfc2b26?pvs=21)  |

### 1-2-1. 이메일로 로그인 ✅

| 항목        | 내용                               |
|-----------|----------------------------------|
| **기능 ID** | USR-002                          |
| **기능명**   | 이메일 로그인                          |
| **목적**    | 사용자가 이메일과 비밀번호를 입력하여 계정에 로그인합니다. |
| **관련 메뉴** | 로그인 페이지 (`/login`)               |
| **입력값**   | - 이메일                            
 - 비밀번호    |
| **처리 로직** | 1. 사용자가 로그인 폼에 정보 입력             

    - 클라이언트에서 이메일과 비밀번호를 입력받아 쿠키와 함께 서버로 전송합니다.
    - 기술: Axios, etc.

2. 서버는 입력된 이메일과 비밀번호를 DB와 확인하여 계정 인증
    - 입력된 이메일을 DB에서 조회(SELECT)하고, 저장된 해시 비밀번호와 입력된 비밀번호를 bcrypt로 비교합니다.
    - 성공 시 JWT 토큰을 발급하여 클라이언트에 반환합니다.
    - 기술: Spring Security, JPA/Hibernate, JWT. |
      | **출력값** | - 로그인 성공 → 로그인 성공 메시지 ("로그인 성공”)

- 로그인 실패 → 인증 실패 메시지 ("이메일 또는 비밀번호가 올바르지 않습니다. 다시 확인해 주세요.”) |
  | **비고** | - 비밀번호 찾기 기능
- 계정 잠금 기능 고려 |
  | API 설계 | [**로그인 (POST /api/v1/users/login)
  **](https://www.notion.so/POST-api-v1-users-login-205df725799740e4851560fbfcb9ad00?pvs=21)  |

### 1-2-2. OAuth로 로그인 ✅

| 항목        | 내용                                 |
|-----------|------------------------------------|
| **기능 ID** | USR-002                            |
| **기능명**   | OAuth 로그인                          |
| **목적**    | 사용자가 다른 서비스의 계정으로 로그인              |
| **관련 메뉴** | 로그인 페이지 (`/login/<provider-name>`) |
| **입력값**   | 없음                                 |
| **처리 로직** | 1. 사용자가 OAuth 공급자 로그인 폼 이동         

    - 클라이언트가 공급자의 로그인 URL로 리다이렉트

2. 공급자가 로그인 후 인증 코드를 클라이언트로 전달
    - 로그인 성공 시 authorization code가 클라이언트로 리다이렉트됩니다.
3. 서버가 인증 코드를 공급자에게 보내 엑세스 토큰을 받음
    - 서버가 authorization code를 POST 요청으로 보내 액세스 토큰을 획득합니다.
    - 기술: Redis
4. 서버가 엑세스 토큰으로 사용자 정보를 조회하고 로그인 처리
    - 엑세스 토큰으로 사용자 정보를 가져와 DB에서 계정을 확인하고, 없으면 생성 후, JWT 토큰을 발급 |
      | **출력값** | - 로그인 성공 → 로그인 성공 메시지 ("로그인 성공”)

- 로그인 실패 → 인증실패 메시지 ("이메일 또는 비밀번호가 올바르지 않습니다. 다시 확인해 주세요.”) |
  | **비고** | - 공급자 로그인 타임아웃 고려 |
  | API 설계 | [OAuth 로그인 ( 추가 필요 )](https://www.notion.so/OAuth-1e03550b7b5580f8b0cbf5103b439ca0?pvs=21)  |

### 1-3. 로그아웃 ✅

| 항목        | 내용                      |
|-----------|-------------------------|
| **기능 ID** | USR-003                 |
| **기능명**   | 로그아웃                    |
| **목적**    | 사용자가 현재 로그인된 세션을 종료합니다. |
| **관련 메뉴** | 로그아웃 버튼 (`/logout`)     |
| **입력값**   | 액세스 토큰, 리프레시 토큰이 포함된 쿠키 |
| **처리 로직** | **1. 사용자가 로그아웃 버튼 클릭**  

    - 클라이언트가 쿠키와 함께 로그아웃 요청을 서버에 보냅니다.
    - 기술: **Axios, etc.**

2. **서버는 리프레시 토큰을 블랙리스트에 저장**
    - 리프레시 토큰을 **Redis**에 저장하여 재사용을 방지합니다.
    - 기술: **Redis**, **Spring Data Redis**.
3. **사용자는 액세스 토큰을 재발급 받을 수 없으므로 로그아웃됨**
    - 클라이언트에서 액세스 토큰과 리프레시 토큰을 삭제합니다.
    - 기술: ??? |
      | **출력값** | 로그아웃 성공 메시지 (”로그아웃 성공”)
      (토큰 인증 오류 시: “인증 정보가 필요합니다.” 메시지) |
      | **비고** | - 블랙리스트 저장소 고민 필요

- 로그인 상태에서 진행 |
  | API 설계 | [ **로그아웃 (POST /api/v1/users/logout)
  **](https://www.notion.so/POST-api-v1-users-logout-10e887f67da048ff8f1dac9fd35f3f6f?pvs=21)  |

### 1-4. 회원탈퇴 ✅

| 항목        | 내용                         |
|-----------|----------------------------|
| **기능 ID** | USR-004                    |
| **기능명**   | 회원탈퇴                       |
| **목적**    | 사용자가 계정을 삭제하고 서비스에서 탈퇴합니다. |
| **관련 메뉴** | 회원탈퇴 페이지 (`/withdraw`)     |
| **입력값**   | - 비밀번호                     |
| **처리 로직** | **(로그인 상태에서만 진행 가능)        

1. 사용자가 비밀번호 입력**
    - 클라이언트에서 비밀번호를 입력받아 서버로 전송합니다.
    - 기술: **Axios, etc.**
2. **서버는 비밀번호 확인 후 계정 삭제**
    - 입력된 비밀번호와 DB의 해시 비밀번호를 **bcrypt**로 비교하고, 일치 시 계정을 삭제합니다.
    - 기술: **Spring Security**, **JPA/Hibernate**.
3. **관련 데이터 삭제**
    - 구매 이력, 문의사항 등 관련 데이터를 삭제하거나 익명화합니다.
    - 기술: **JPA/Hibernate**. |
      | **출력값** | 회원탈퇴 완료 메시지 (”회원 탈퇴 성공”)
      (오류 시: “인증 정보가 필요합니다.” 메시지) |
      | **비고** | x |
      | API 설계 | [**회원탈퇴 (DELETE /api/v1/users/me)
      **](https://www.notion.so/DELETE-api-v1-users-me-39c06175512b46ce9b1dc26dafedfd84?pvs=21)  |

---

## 2. 마이페이지 ✅

### 2-1. 개인정보 조회 및 수정

| 항목        | 내용                                    |
|-----------|---------------------------------------|
| **기능 ID** | MYP-001                               |
| **기능명**   | 개인정보 관리                               |
| **목적**    | 사용자가 개인정보를 조회하고 수정합니다.                |
| **관련 메뉴** | 마이페이지 > 개인정보 (**`/api/v1/users/me`**) |
| **입력값**   | - 수정할 개인정보                            |
| **처리 로직** | 1. 사용자가 정보 수정                         

2. 서버가 수정된 정보 저장
3. 저장 성공 여부 확인 |
   | **출력값** | 수정 완료 메시지
   (오류 시: “토큰이 만료되었습니다. 다시 로그인해주세요.” 토큰 만료 메시지) |
   | **비고** | - 비밀번호/이메일 변경 기능 포함

- 수정 가능 정보
  • 비밀번호 변경
  • 거주지역 변경
  • 결제수단 관리
  • 핸드폰 번호 변경 |
  | API 설계 | [**프로필 조회 (GET /api/v1/users/me)
  **](https://www.notion.so/GET-api-v1-users-me-9ae445b393714654a8842fc06a69b624?pvs=21)
  [**프로필 수정 (PUT /api/v1/users/me)
  **](https://www.notion.so/PUT-api-v1-users-me-91cec066621443acac5d7920eaaa17ef?pvs=21)  |

### 2-2. 구매 이력 조회 ✅

| 항목        | 내용                                       |
|-----------|------------------------------------------|
| **기능 ID** | MYP-002                                  |
| **기능명**   | 구매 이력 조회                                 |
| **목적**    | 사용자가 구매한 티켓 이력을 확인합니다.                   |
| **관련 메뉴** | 마이페이지 > 구매 이력 `GET /users/me/purchases`) |
| **입력값**   | -                                        |
| **처리 로직** | 1. 사용자가 구매 이력 페이지 접속                     

2. 서버가 구매 이력 조회
3. 조회 결과 반환 |
   | **출력값** | 구매 이력 리스트(티켓 일정, QR 코드 포함)
   (오류 시: 조회 실패 메시지) |
   | **비고** | - QR 코드 표시 기능 |
   | API 설계 | [**구매 이력 조회 (GET /api/v1/users/me/purchases)
   **](https://www.notion.so/GET-api-v1-users-me-purchases-1e03550b7b558032a4bdf7221bdf0b3a?pvs=21)  |

### 2-3. 관심 행사 조회 ⏳

| 항목        | 내용                                           |
|-----------|----------------------------------------------|
| **기능 ID** | MYP-003                                      |
| **기능명**   | 관심 행사 조회                                     |
| **목적**    | 사용자가 좋아요를 누른 행사의 리스트를 조회합니다.                 |
| **관련 메뉴** | 마이페이지 > 관심 행사 (**`/api/v1/users/me/likes`**) |
| **입력값**   | -                                            |
| **처리 로직** | 1. 관심 행사 페이지 접속                              

2. 서버에서 유저의 관심 행사 연관관계 조회 및 반환
3. 관심 행사 리스트 출력 |
   | **출력값** | 관심 행사 리스트가 출력된 페이지 |
   | **비고** | |
   | API 설계 | [**관심 행사 목록 조회 (GET /api/v1/users/me/likes)
   **](https://www.notion.so/GET-api-v1-users-me-likes-2539242338dd436ab40e03537394b354?pvs=21)  |

---

## 3. 티켓 구매 ✅

### 3-1. 티켓 구매 및 좌석 결정 ✅

| 항목                 | 내용                                     |
|--------------------|----------------------------------------|
| **기능 ID**          | TKT-001                                |
| **기능명**            | 티켓 구매                                  |
| **목적**             | 사용자가 특정 행사의 티켓을 구매합니다.                 |
| **관련 메뉴**          | 행사 상세 페이지 (`/event/{id}`)              |
| **입력값**            | - 좌석 선택 (지정석인 경우: 좌석 번호, 미지정석의 경우: 수량) 
 - 티켓 수량 (미지정석인 경우) |
| **처리 로직**          | **1. 사용자가 티켓 구매 버튼 클릭**                

    - 클라이언트가 행사 ID와 함께 구매 요청을 서버로 보냅니다.
    - 기술: **Axios**.

2. **서버는 대기열에 해당 사용자 추가**
    - **Redis Sorted Set**을 사용하여 사용자 대기열을 관리합니다.
    - 기술: **Redis**, **Spring Data Redis**.
3. **대기열 통과 이후 좌석 선택**
    - 대기열 순서가 되면 좌석 선택 페이지로 이동하며, 사용자가 좌석을 선택합니다.
    - 기술: **WebSocket** (실시간 업데이트).
4. **결제 페이지로 이동**
    - 좌석 선택 후 **Redisson Lock**으로 좌석을 잠가 다른 사용자의 중복 선택을 방지하고 결제 페이지로 이동합니다.
    - 기술: **Redisson**, **Spring MVC**. |
      | **출력값** | 결제 페이지
      (오류 시: 구매 불가 메시지) |
      | **비고** | - 예매 대기열 기능 구현 고민 필요

- 다른 유저가 동일 좌석 선택하지 않도록 락 걸어야 함 |
  | API 설계 | [**대기열 진입 (POST /api/v1/event/{event-id}/tickets/waiting)
  **](https://www.notion.so/POST-api-v1-event-event-id-tickets-waiting-1df3550b7b5580129f68c6e290359788?pvs=21)
  [**대기열 조회 (GET /api/v1/waiting)**](https://www.notion.so/GET-api-v1-waiting-1df3550b7b5580418c81c116e62bf698?pvs=21)
  [**대기열 취소 (DELETE /api/v1/waiting)
  **](https://www.notion.so/DELETE-api-v1-waiting-1df3550b7b5580f8a3bde4904529e03d?pvs=21)
  [**좌석 조회 (GET /api/v1/event/{event-id}/seats)
  **](https://www.notion.so/GET-api-v1-event-event-id-seats-1df3550b7b5580de9d48d6980d3a7205?pvs=21)
  [**좌석 선택 (POST /api/v1/event/{event-id}/seats)
  **](https://www.notion.so/POST-api-v1-event-event-id-seats-1df3550b7b558016a158c8f777f3548d?pvs=21)
  [**좌석 취소 (DELETE /api/v1/event/{event-id}/seats)
  **](https://www.notion.so/DELETE-api-v1-event-event-id-seats-1df3550b7b5580d1b995cd0e2d6ebeb0?pvs=21)  |

### 3-2. 결제 ✅

| 항목        | 내용                          |
|-----------|-----------------------------|
| **기능 ID** | TKT-002                     |
| **기능명**   | 결제                          |
| **목적**    | 사용자가 티켓 구매 시 결제를 진행합니다.     |
| **관련 메뉴** | 결제 페이지 (`/payment`)         |
| **입력값**   | - 결제 수단 (카드, 계좌 이체, 간편결제 등) 

- 결제 정보 ( 카드 번호, 유효기간, CVC 등 → 결제 수단에 따라 다름)
- 할인 코드(옵션) |
  | **처리 로직** | 1. 사용자가 결제 수단 선택 및 금액 확인

2. 서버는 결제 플랫폼과 연동하여 결제 처리
3. 결제 성공 시 티켓 발급 및 구매 이력 저장 |
   | **출력값** | 결제 성공 메시지 및 티켓 정보
   (오류 시: 결제 실패 메시지) |
   | **비고** | - 할인 |
   | | |

### 3-3. 취소 / 환불 ✅

| 항목                                   | 내용                                |
|--------------------------------------|-----------------------------------|
| **기능 ID**                            | TKT-003                           |
| **기능명**                              | 취소 / 환불                           |
| **목적**                               | 사용자가 구매한 티켓을 취소하거나 환불합니다.         |
| **관련 메뉴**                            | 마이페이지 > 구매 이력 (`/mypage/tickets`) |
| **입력값**                              | - 취소 사유 (선택 사항)                   
 - 환불 계좌 정보 (환불 시 필요: 은행명, 계좌번호, 예금주) |
| **처리 로직**                            | 1. 사용자가 취소/환불 버튼 클릭               

2. 서버는 취소/환불 가능 여부 확인(행사 당일 1일 이전 불가능)
3. 환불 처리 진행 |
   | **출력값** | 취소/환불 완료 메시지 및 환불 금액
   (오류 시: 불가 메시지) |
   | **비고** | - 취소/환불 시한 관리 |
   | API 설계 | [**유저 환불 (POST /api/v1/payments/{paymentKey}/cancel)
   **](https://www.notion.so/POST-api-v1-payments-paymentKey-cancel-1df3550b7b558096b4a6f49106f51019?pvs=21)  |

---

## 4. 알림 ✅

### 4-1. 외부 알림 생성 ✅

| 항목                    | 내용                         |
|-----------------------|----------------------------|
| **기능 ID**             | NTF-001                    |
| **기능명**               | 외부 알림                      |
| **목적**                | 사용자에게 SMS, 이메일로 알림을 전송합니다. |
| **관련 메뉴**             |                            |
| **입력값**               | -                          |
| **처리 로직**             | 1. 서버가 알림 유형에 따라 해당 채널로 전송 
 2. 전송 성공 여부 확인        |
| **출력값**               | 전송된 알림                     |
| **비고**                | - 알림 유형                    
 티켓 구매 시 :  QR + 구매 정보 |

### 4-2. 내부 알림 생성 ✅

| 항목             | 내용                            |
|----------------|-------------------------------|
| **기능 ID**      | NTF-002                       |
| **기능명**        | 내부 알림                         |
| **목적**         | 웹 사이트 내에서 토스트 메시지로 알림을 표시합니다. |
| **관련 메뉴**      |                               |
| **입력값**        | - 알림 유형                       
 - 알림 내용        |
| **처리 로직**      | 1. 서버가 알림 유형에 따라 내부 알림 전송     
 2. 전송 성공 여부 확인 |
| **출력값**        | 알림 전송 성공 여부                   |
| **비고**         | - 알림 유형                       

티켓 구매 시 : “예매가 완료되었습니다.”
”오늘 개최되는 이벤트가 있습니다.” |
| API 설계 | [**알림 구독 (GET /api/v1/notifications/subscribe)
**](https://www.notion.so/GET-api-v1-notifications-subscribe-1e03550b7b5580f7a0b3fbd98ec928e8?pvs=21)  |

### 4-3. 알림 목록 조회 ✅

| 항목        | 내용                         |
|-----------|----------------------------|
| **기능 ID** | NTF-003                    |
| **기능명**   | 알림 목록 조회                   |
| **목적**    | 로그인한 사용자의 모든 알림 내역을 조회합니다. |
| **관련 메뉴** | 헤더                         |
| **입력값**   | -                          |
| **처리 로직** | 1. 서버가 알림 유형에 따라 내부 알림 전송  

2. 사용자가 수신함 접근하여 알림 목록 조회
2. 조회 결과 반환 |
   | **출력값** | 알림 목록 |
   | **비고** | - 읽지 않은 알림 클릭 시 읽음으로 처리 |
   | API 설계 | [**알림 목록 조회 (GET /api/v1/notifications)
   **](https://www.notion.so/GET-api-v1-notifications-4dbf768306854302bf3123ea0f599c38?pvs=21)  |

### 4-4. 알림 상세 조회 ✅

| 항목          | 내용                                                                                                                                         |
|-------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| **기능 ID**   | NTF-004                                                                                                                                    |
| **기능명**     | 알림 상세 조회                                                                                                                                   |
| **목적**      | 로그인한 사용자의 단건 알림의 상세 정보를 조회합니다.                                                                                                             |
| **관련 메뉴**   | 헤더 > 알림 목록                                                                                                                                 |
| **입력값**     | -                                                                                                                                          |
| **처리 로직**   | 1. 사용자가 수신함 접근하여 알림 목록 조회 후 알림 클릭                                                                                                          
 2. 조회 결과 반환 |
| **출력값**     | 알림 상세 정보                                                                                                                                   |
| **비고**      | - 읽지 않은 알림 클릭 시 읽음으로 처리                                                                                                                    |
| API 설계      | [**알림 상세 조회 (GET /api/v1/notifications/{id})**](https://www.notion.so/GET-api-v1-notifications-id-161431e31fd54bc996bc69c4bcae9007?pvs=21) |

---

## 5. 행사 조회 ✅

### 5-1. 행사 리스트 조회 ✅

| 항목                                   | 내용                               |
|--------------------------------------|----------------------------------|
| **기능 ID**                            | EVT-001                          |
| **기능명**                              | 행사 리스트 조회                        |
| **목적**                               | 사용자가 필터링 및 검색을 통해 행사 리스트를 조회합니다. |
| **관련 메뉴**                            | 행사 리스트 페이지 (`/events`)           |
| **입력값**                              | - 검색어                            
 - 필터링 조건(지역, 금액대, 장르, 일정: 종료/진행중/예정) |
| **처리 로직**                            | 1. 사용자가 검색어 입력 및 필터링 조건 선택       

2. 서버가 조건에 맞는 행사 리스트 조회
3. 조회 결과 반환 |
   | **출력값** | 행사 리스트
   (오류 시: 조회 실패 메시지) |
   | **비고** | - 복수 선택 가능한 필터링 지원 |
   | API 설계 | [**이벤트 목록 조회 (GET /api/v1/events)
   **](https://www.notion.so/GET-api-v1-events-7d8286b1558f4ca890af909ca5b54c3b?pvs=21)  |

### 5-2. 행사 상세 조회 ✅

| 항목        | 내용                        |
|-----------|---------------------------|
| **기능 ID** | EVT-002                   |
| **기능명**   | 행사 상세 조회                  |
| **목적**    | 사용자가 특정 행사의 상세 정보를 확인합니다. |
| **관련 메뉴** | 행사 상세 페이지 (`/event/{id}`) |
| **입력값**   |                           |
| **처리 로직** | 1. 사용자가 행사 상세 페이지 접속      

2. 서버가 행사 ID로 상세 정보 조회
3. 조회 결과 반환 |
   | **출력값** | 행사 상세 정보
   • 가격 및 공연 정보 안내
   • 매니저 정보 : 닉네임, 문의 전화번호, 이메일
   • 좋아요 (마이페이지 > 관심공유)
   • 티켓 구매 이동 버튼
   • 공유 기능 : 링크만 딸 수 있게 + 트위터/카카오톡으로 공유 링크 생성 ( 옵션 )
   • 예매자 통계
   ◦ 성별별 통계
   ◦ 연령별 통계
   (오류 시: 조회 실패 메시지) |
   | **비고** | - 후기 작성 및 행사 신고 기능 포함 |
   | API 설계 | [**이벤트 상세 조회 (GET /api/v1/events/{id})
   **](https://www.notion.so/GET-api-v1-events-id-1241891742ab46708b5bb37a44d768fe?pvs=21)  |

---

## 6. 매니저 기능 ✅

### 6-1. 행사 정보 생성 및 수정 ✅

| 항목        | 내용                                  |
|-----------|-------------------------------------|
| **기능 ID** | MGR-001                             |
| **기능명**   | 행사 정보 생성 및 수정                       |
| **목적**    | 매니저가 행사 정보를 생성하고 수정합니다. (삭제 불가)     |
| **관련 메뉴** | 매니저 페이지 > 행사 관리 (`/manager/events`) |
| **입력값**   | - 제목                                

- 썸네일
- 상세 설명
    - 관람 연령, 제한 사항
    - 장르
    - 공연 장소
    - 좌석 수
    - 예매 시작 일시
    - 예매 종료 일시
    - 행사 시작 일자
    - 행사 종료 일자
    - 티켓별 가격 (티켓 등급당 가격이 다를 경우)
    - 오시는 길
    - 좌석 배치도 (지정 / 미지정): 지정좌석이면 좌표 혹은 번호로 좌석 생성 / 미지정석이면 수량으로 좌석 생성 |
      | **처리 로직** | 1. 매니저가 행사 폼 작성

2. 정보 전송 전 날짜 유효성 검사 및 필수값 입력 확인
3. 서버에 정보 저장
3. 저장 성공 여부 확인 |
   | **출력값** | 저장 완료 메시지 및 행사 정보
   (오류 시: 저장 실패 메시지) |
   | **비고** | - 매니저 권한 인증

- 수정 시 기존 정보 불러오기
- 수정은 예매 시작 전까지 가능 |
  | API 설계 | [**이벤트 생성 (POST /api/v1/manager/events)
  **](https://www.notion.so/POST-api-v1-manager-events-be87a69e5adb421da62909953bedb56e?pvs=21)
  [**이벤트 수정 (PUT /api/v1/manager/events/{event-Id})
  **](https://www.notion.so/PUT-api-v1-manager-events-event-Id-45b184f7b5ed426bb891ac6f388885e8?pvs=21)
  [**이벤트 삭제 (PATCH /api/v1/manager/events/{eventId})
  **](https://www.notion.so/PATCH-api-v1-manager-events-eventId-cf7ab9c0494f460084f73d49bbbec145?pvs=21)
  [**자신이 작성한 이벤트 목록 (GET /api/v1/manager/events)
  **](https://www.notion.so/GET-api-v1-manager-events-eda35cafee204f28b1d54b57038482ef?pvs=21)
  [**행사의 티켓 구매 내역 조회 (GET /api/v1/manager/{eventId}/purchases)
  **](https://www.notion.so/GET-api-v1-manager-eventId-purchases-1df3550b7b5580049226fa17eb7c2fbf?pvs=21)  |

### 6-2. 환불 ✅

| 항목        | 내용                                     |
|-----------|----------------------------------------|
| **기능 ID** | MGR-004                                |
| **기능명**   | 환불                                     |
| **목적**    | 매니저가 특수 상황에서 환불 정책과 관계없이 전액 환불을 진행합니다. |
| **관련 메뉴** | 매니저 페이지 > 환불 (`/manager/refund`)       |
| **입력값**   | -                                      |
| **처리 로직** | 1. 매니저가 행사 선택                          

2. 서버가 전액 환불 처리
   2-1. 암표 구매 적발 시 유저 선택 후 환불 처리
3. 처리 성공 여부 확인 |
   | **출력값** | 환불 완료 메시지
   (오류 시: 환불 실패 메시지) |
   | **비고** | - 매니저 권한 인증

- 환불 수수료 정의 필요
- 특수한 상황
    - 암표 구매 적발
    - 기상 악화 등으로 인한 전체 환불
- 환불 사유 기록 기능 (옵션) |
  | API 설계 | [**매니저 환불 처리 (POST /api/v1/manager/purchases/{purchase-id}/refund)
  **](https://www.notion.so/POST-api-v1-manager-purchases-purchase-id-refund-95fb1588534c446cabea50783ebc1283?pvs=21)  |

### 6-3. 통계 ⏳

| 항목        | 내용                                   |
|-----------|--------------------------------------|
| **기능 ID** | MGR-005                              |
| **기능명**   | 통계                                   |
| **목적**    | 매니저가 구매자 나이대별, 성별 통계를 조회합니다.         |
| **관련 메뉴** | 매니저 페이지 > 통계 (`/manager/statistics`) |
| **입력값**   | -                                    |
| **처리 로직** | 1. 매니저가 행사 선택                        

2. 서버가 나이대별, 성별, 장르별(옵션) 각 통계 계산
3. 계산 결과 반환 |
   | **출력값** | 행사 및 통계 정보
   (오류 시: 조회 실패 메시지) |
   | **비고** | - 매니저 권한 인증

- 차트 (원형/막대 등)으로 시각화 제공 |
  | API 설계 | [**티켓 판매 통계 조회 (GET /api/v1/events/{eventId}/statistics)
  **](https://www.notion.so/GET-api-v1-events-eventId-statistics-1e03550b7b55803b9a38c966eca48ecf?pvs=21)  |

### 6-4. 매니저 알림 ⏳

| 항목             | 내용                                    |
|----------------|---------------------------------------|
| **기능 ID**      | MGR-007                               |
| **기능명**        | 매니저 알림                                |
| **목적**         | 매니저에게 웹 사이트 내의 토스트 알림과 SMS, 메일 알림을 전송 |
| **관련 메뉴**      |                                       |
| **입력값**        | -                                     |
| **처리 로직**      | 1. 서버가 알림 유형에 따라 내부 알림 전송             
 2. 전송 성공 여부 확인 |
| **출력값**        | 알림 전송 성공 여부                           |
| **비고**         | - 알림 유형                               

행사 문의사항이 등록될 경우
행사 예매율이 90% 이상인 경우
행사 시작 일정 1일 전인 경우 |

---

## 7. 운영자 기능 ⏳

### 7-1. 운영자 회원가입⏳

| 항목        | 내용                     |
|-----------|------------------------|
| **기능 ID** | ADM-000                |
| **기능명**   | 회원가입                   |
| **목적**    | 새로운 운영자를 추가한다.         |
| **관련 메뉴** | 회원가입 페이지 (`/register`) |
| **입력값**   | - 이메일                  
 - 비밀번호    |
| **처리 로직** | 1. 사용자가 회원가입 폼에 정보 입력  

    - 클라이언트에서 이메일과 비밀번호를 입력받아 서버로 전송합니다.
    - 기술: Axios, ???

2. 서버는 입력된 정보를 서버에 저장해 회원가입 |
   | **출력값** | - 회원가입 성공 → 회원가입 성공 메시지 ("회원가입 성공! 환영합니다!”)

- 회원가입 실패 → 회원가입 실패 메시지 ("중복된 이메일입니다”) |
  | **비고
  ** | [운영자 회원가입 ( POST /api/v1/admin)](https://www.notion.so/POST-api-v1-admin-1e03550b7b5580458e42de98faa7a7a5?pvs=21)  |

### 7-2. 운영자 로그인 ⏳

| 항목        | 내용                               |
|-----------|----------------------------------|
| **기능 ID** | ADM-001                          |
| **기능명**   | 로그인                              |
| **목적**    | 운영자가 이메일과 비밀번호를 입력하여 계정에 로그인합니다. |
| **관련 메뉴** | 로그인 페이지 (`/login`)               |
| **입력값**   | - 이메일                            
 - 비밀번호    |
| **처리 로직** | 1. 사용자가 로그인 폼에 정보 입력             

    - 클라이언트에서 이메일과 비밀번호를 입력받아 서버로 전송합니다.
    - 기술: Axios, ???

2. 서버는 입력된 이메일과 비밀번호를 DB와 확인하여 계정 인증
    - 입력된 이메일을 DB에서 조회(SELECT)하고, 저장된 해시 비밀번호와 입력된 비밀번호를 bcrypt로 비교합니다.
    - 성공 시 JWT 토큰을 발급하여 클라이언트에 반환합니다.
    - 기술: Spring Security, JPA/Hibernate, JWT. |
      | **출력값** | - 로그인 성공 → 로그인 성공 메시지 ("로그인 성공! 환영합니다!”)

- 로그인 실패 → 로그인 실패 메시지 ("이메일 또는 비밀번호가 올바르지 않습니다. 다시 확인해 주세요.”) |
  | **비고** | - 비밀번호 찾기 기능
- 계정 잠금 기능 고려 |
  | API
  설계 | [운영자 로그인( POST /api/v1/admin/login](https://www.notion.so/POST-api-v1-admin-login-1e03550b7b558050aafbff26fc1ec4d9?pvs=21)  |

### 7-3. 사용자 / 매니저 관리 ⏳

| 항목        | 내용                                          |
|-----------|---------------------------------------------|
| **기능 ID** | ADM-002                                     |
| **기능명**   | 사용자 / 매니저 관리                                |
| **목적**    | 운영자가 사용자와 매니저를 관리하고 권한을 부여하며 불량 사용자를 제재합니다. |
| **관련 메뉴** | 운영자 페이지 > 사용자 관리 (`/admin/users`)           |
| **입력값**   | - 사용자 / 매니저 ID                              

- 이름
- 이메일
- 정지 기간(3일, 7일, 1달, 무기한)
- 권한 변경 정보(사용자 ↔ 매니저) |
  | **처리 로직** | 1. 운영자가 사용자/ 매니저 목록 조회

2. 관리할 대상 선택 및 상세 정보 확인
3. 필요한 관리 작업 수행(권한 변경, 블랙리스트 등록)
4. 서버가 변경사항 저장
5. 변경 내역 로그 기록 및 결과 변환 |
   | **출력값** | - 사용자 / 매니저 목록 및 상세 정보

- 작업 결과 메시지
- 오류 시 : 실패 사유와 함께 오류 메시지 |
  | **비고** | - 정지 기간동안 로그인 불가
- 블랙리스트 등록 시 사유 명시 |
  | API 설계 | [**사용자 정지 (DELETE /admin/users/{id})
  **](https://www.notion.so/DELETE-admin-users-id-1e03550b7b558098835ce2011fb27077?pvs=21)
  [**사용자 상세 조회 (GET /api/v1/admin/users/{id})
  **](https://www.notion.so/GET-api-v1-admin-users-id-1e03550b7b558011b1f8c598c35edf46?pvs=21)
  [**사용자 목록 조회 (GET /api/v1/admin/users)
  **](https://www.notion.so/GET-api-v1-admin-users-1e03550b7b5580e68c23d82a6a53d16f?pvs=21)  |

### 7-3. 플랫폼 모니터링 ⏳

| 항목        | 내용                                                     |
|-----------|--------------------------------------------------------|
| **기능 ID** | ADM-003                                                |
| **기능명**   | 플랫폼 모니터링                                               |
| **목적**    | 운영자가 서버, 시스템 리소스, 티켓팅 대기열 등 플랫폼 전반의 상태를 실시간으로 모니터링합니다. |
| **관련 메뉴** | 운영자 페이지 > 모니터링 (`/admin/monitoring`)                   |
| **입력값**   | - 조회 기간(실시간/일별/주별/월별)                                  

- 모니터링 대상(서버/DB/네트워크/대기열)
- 알림 임계값 설정 |
  | **처리 로직** | 1. 운영자가 모니터링 페이지 접속

2. 서버가 Grafana 모니터링 시스템과 연동하여 데이터 수집
3. 수집한 데이터 시각화 및 제공
4. 임계치 초과 시 자동 알림 생성 |
   | **출력값** | - CPU/메모리/디스크 사용량

- 초당 요청 수 및 응답 시간
- 대기열 상태 및 사용자 수
- 서버 상태(정상/주의/경고/위험)
- 오류 시 : 데이터 수집 실패 메시지 |
  | **비고** | - 모니터링 데이터는 최소 3초 간격으로 갱신
- 티켓팅 오픈 시간에는 모니터링 강화 권장
- 과도한 모니터링으로 인한 시스템 부하 방지 필요
- 시스템 장애 발생 시 자동 리포트 생성 |
  | | |

### 7-4. 운영자 알림 ⏳

| 항목             | 내용                               |
|----------------|----------------------------------|
| **기능 ID**      | ADM-004                          |
| **기능명**        | 알림                               |
| **목적**         | 토스트 메시지와 SMS, 메일로 운영자에게 알림을 보냅니다 |
| **관련 메뉴**      |                                  |
| **입력값**        | -                                |
| **처리 로직**      | 1. 서버가 알림 유형에 따라 알림 전송           
 2. 전송 성공 여부 확인 |
| **출력값**        | 알림 전송 성공 여부                      |
| **비고**         | - 알림 유형                          

시스템 문의사항이 등록될 경우
트래픽이 몰릴 경우 ( 구체적인 tps 기준 필요) |

---

---